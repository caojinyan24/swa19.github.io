<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>机器学习相关算法 - </title>
	<link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="/css/index.css">
	<link rel="stylesheet" href="/css/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/syntax.css">
	<link rel="canonical" href="/%E5%85%B6%E4%BB%96/2018/03/02/machine-learning.html">
	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	<meta name="keywords" content="机器学习相关算法, , ">
	<meta name="description" content="">
	<script src="/js/jquery.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/html5shiv.js"></script>
	<script src="/js/holder.min.js"></script>
	<script src="/js/respond.js"></script>
	<script src="/js/application.js"></script>
	<script src="/js/lessismore.js"></script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>

<body class="index">

<header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">    
        <li>
          <a href="/">主页</a>
        </li>
        <li>
          <a href="/categories/">类别</a>
        </li>
        <li>
          <a href="/tags">标签</a>
        </li>
      </ul>

    </nav>
  </div>

</header>
<div class="docs-header" id="content">
  <div class="container">
  	
		    <h1></h1>
      <p>不积跬步，无以至千里</p>
      
  </div>
</div>
<!---->
<!--<div class="banner">
    <div class="container">
        
        <a href="/categories/#其他-ref">其他</a>
        /
        <a href="/tags/#python-ref">python</a>
        
    </div>
</div>
-->
<!---->

<div class="container docs-container">
    <div class="row">
        <div class="col-md-3">
        <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
    <h1>目录</h1>
    <ul class="nav sidenav">
        
        
        
        
        
        
        <li><a href="#year_2019">2019</a>
            <ul class="nav">
                <li><a href="#month_2019_02">02</a></li>
                
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
    </ul>
    </li>
    <li><a href="#year_2018">2018</a>
        <ul class="nav">
            <li><a href="#month_2018_11">11</a></li>
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_10">10</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_09">09</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_08">08</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_07">07</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_06">06</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_05">05</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_04">04</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_03">03</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_02">02</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2018_01">01</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
    </ul>
    </li>
    <li><a href="#year_2017">2017</a>
        <ul class="nav">
            <li><a href="#month_2017_12">12</a></li>
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2017_11">11</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2017_09">09</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
        
            
            <li><a href="#month_2017_08">08</a></li>
            
            
            
            
        
        
        
        
        
                
        
            
            
            
            
        
        
        
        
        
                
            </ul>
        </li>
        
            
        </ul>
</div>



        </div>
        </div>
        <div class="col-md-9" role="main">
            <div class="panel docs-content">
            <div class="wrapper">
                <header class="post-header">
                    <h1 class="post-title">机器学习相关算法</h1>
                    <div class="meta"><span class="postdate">2018-03-02 15:13:55</span></div>
                    <br/>
                </header>
                <article class="post-content">
                    <ul id="markdown-toc">
  <li><a href="#朴素贝叶斯" id="markdown-toc-朴素贝叶斯">朴素贝叶斯</a>    <ul>
      <li><a href="#算法修正" id="markdown-toc-算法修正">算法修正</a></li>
    </ul>
  </li>
  <li><a href="#逻辑回归" id="markdown-toc-逻辑回归">逻辑回归</a></li>
</ul>

<h1 id="朴素贝叶斯">朴素贝叶斯</h1>
<ol>
  <li>将要处理的数据转换为数字</li>
  <li>分别计算待测试的文档中的每个单词，出现在不同类别的概率。
对于一个包含字符串的数组：<code class="highlighter-rouge">test_list=['problems', 'buying', 'him', 'has', 'quit', 'how', 'steak', 'help', 'please', 'flea', 'mr', 'ate', 'garbage', 'worthless', 'love', 'maybe', 'I', 'posting', 'licks', 'stupid', 'not', 'food', 'to', 'dog', 'so', 'is', 'cute', 'dalmation', 'park', 'my', 'take', 'stop']</code>
假定有两个类别：0和1.要判断该一个字符串数组属于类别0，会给出字符串数组。
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sample_list = [['my', 'dog', 'has', 'flea', 'problems', 'help', 'please'],
                 ['maybe', 'not', 'take', 'him', 'to', 'dog', 'park', 'stupid'],
                 ['my', 'dalmation', 'is', 'so', 'cute', 'I', 'love', 'him'],
                 ['stop', 'posting', 'stupid', 'worthless', 'garbage'],
                 ['mr', 'licks', 'ate', 'my', 'steak', 'how', 'to', 'stop', 'him'],
                 ['quit', 'buying', 'worthless', 'dog', 'food', 'stupid']]
 class_vec = [0, 1, 0, 1, 0, 1]
</code></pre></div>    </div>
    <p>对给定的字符串数组test_list,需要判定的是其中的每个单词分别出现在类别0和1中的概率。
具体怎么计算呢？在第1步中，test_list和sample_list做比对后，获得一个矩阵：</p>
  </li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix=
[[1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0], 
[0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0], 
[0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1], 
[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 
[0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0], 
[0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0]]
</code></pre></div></div>
<p>python：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def set_of_words2_vec(vocab_list, input_set):
    return_vec = [0] * len(vocab_list)
    for word in input_set:
        if word in vocab_list:
            return_vec[vocab_list.index(word)] = 1
        else:
            print("the wojrd:%s is not in my vocabulary", word)
    return return_vec

train_mat = []
for postin_doc in sample_list:
    train_mat.append(set_of_words2_vec(test_list, postin_doc))
</code></pre></div></div>

<p>这个矩阵和数组class_vec中的类别对应，以matrix[0]为例，matrix[0]对应class_vec[0],即matrix[0]中，被标记为1的字符串被判定为在类别0中出现。
接下来计算针对类别0，计算test_list中的每个单词出现在类别0中的概率。
取出matrix[0],matrix[2],matrix[4],计算其中的1出现的总次数<code class="highlighter-rouge">p0_num=24</code>，
<code class="highlighter-rouge">matrix[0]+matrix[2]+matrix[4]</code>获得每个单词在不同的类别0样本中出现的次数和<code class="highlighter-rouge">p0_vec=[0. 0. 1. 0. 1. 1. 0. 1. 0. 1. 0. 1. 1. 3. 1. 0. 1. 1. 1. 0. 1. 1. 1. 1. 0. 2. 1. 0. 1. 1. 0. 1.]</code>
那么要计算其中的每个单词属于类别0的概率就是<code class="highlighter-rouge">p0_vec/p0_num</code>,即：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0.05263158 0.05263158 0.         0.05263158 0.05263158 0.
 0.05263158 0.05263158 0.05263158 0.05263158 0.05263158 0.05263158
 0.         0.05263158 0.05263158 0.         0.         0.05263158
 0.05263158 0.05263158 0.         0.05263158 0.15789474 0.
 0.05263158 0.         0.05263158 0.         0.10526316 0.
 0.05263158 0.        ]
</code></pre></div></div>
<p>同样的方式计算test_list中每个单词属于类别1的概率：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0.         0.         0.05263158 0.05263158 0.         0.05263158
 0.         0.10526316 0.         0.         0.         0.
 0.05263158 0.         0.         0.05263158 0.05263158 0.
 0.         0.05263158 0.10526316 0.         0.         0.15789474
 0.         0.05263158 0.         0.05263158 0.05263158 0.05263158
 0.         0.05263158]
</code></pre></div></div>

<p>python:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def train_nb_0(train_mat, class_vec):
    num_train_docs = len(train_mat)
    num_words = len(train_mat[0])
    p_abusive = sum(class_vec) / float(num_train_docs)  # 代表划分为类别1的样本占总样本的比例（0.5）
    p0_num = zeros(num_words)
    p1_num = zeros(num_words)
    p0_denom = 0.0
    p1_denom = 0.0
    for i in range(num_train_docs):
        if class_vec[i] == 1:
            p1_num += train_mat[i]
            p1_denom += sum(train_mat[i])
        else:
            p0_num += train_mat[i]
            p0_denom += sum(train_mat[i])
    print(p0_num)
    print(p1_num)
    p1_vect = p1_num / p1_denom
    p0_vect = p0_num / p0_denom
    print(p0_vect)
    print(p1_vect)
    print(p_abusive)
    return p0_vect, p1_vect, p_abusive
</code></pre></div></div>

<h2 id="算法修正">算法修正</h2>
<ol>
  <li>为了计算概率的乘积，消除概率为0的情况</li>
  <li>为了避免过小的浮点数做乘积运算时丧失运算精度，将乘积换做对数的相加。即 a*b&lt;=&gt;loga+logb</li>
</ol>

<p>使用bayes算法做分类器
原理：在上一个算法中，根据给定的实验样本，计算出了每个单词属于不同类别的概率。在对一个文档做分类的时候，也就知道了这个文档中的单词属于不同类别的概率，通过对这些概率做相乘（对数相加），获得这篇文档中所有单词分别属于类别0和1的概率，比较这两个概率大小来对文档做分类。
首先，对于给定的一篇文档，<code class="highlighter-rouge">test_entry = ['love', 'my', 'dalmation']</code>，将其转换为数组为：<code class="highlighter-rouge">test_vec=[0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0]</code>，这个test_vec数组的长度等于实验样本中包含的不重复的单词的数量，其中的1代表测试文档中的单词在实验样本中出现的次数。
通过上一个步骤，我们已经知道了对应于每个单词分别属于类别0和1的概率（p0_vec和p1_vec），所以p0_vec<em>test_vec可以用来衡量测试文档属于类别0的概率，sum（p0_vec</em>test_vec）也就是属于类别0的总概率。</p>

<p>python：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def train_nb_0(train_matrix, train_category):
    num_train_docs = len(train_matrix)
    num_words = len(train_matrix[0])
    p_abusive = sum(train_category) / float(num_train_docs)  # 代表划分为类别1的样本占总样本的比例（0.5）
    p0_num = ones(num_words)   #数组用1来填充
    p1_num = ones(num_words)
    p0_denom = 2.0
    p1_denom = 2.0
    for i in range(num_train_docs):
        if train_category[i] == 1:
            p1_num += train_matrix[i]
            p1_denom += sum(train_matrix[i])
        else:
            p0_num += train_matrix[i]
            p0_denom += sum(train_matrix[i])
    p1_vect = log(p1_num / p1_denom)    #对概率值取对数
    p0_vect = log(p0_num / p0_denom)
    return p0_vect, p1_vect, p_abusive

# p0_vec对应各个单词属于类别0的概率；vec2_classify对应实验样本转换为数字后的数组。p0和p1分别对应各个单词位于类别0和1的概率之和
def classify_nb(vec2_classify, p0_vec, p1_vec, p_class1):
    p1 = sum(vec2_classify * p1_vec) + log(p_class1)   以概率对数的相加替换概率的乘积
    p0 = sum(vec2_classify * p0_vec) + log(1.0 - p_class1)
    if p1 &gt; p0:
        return 1
    else:
        return 0
</code></pre></div></div>

<h1 id="逻辑回归">逻辑回归</h1>


                </article>
                </div>
            </div>
        </div>
    </div>
</div>


<footer class="footer" role="contentinfo">
	<div class="container">
		<div class="footer-col-wrapper">
			<div class="footer-col footer-col-2">
				<ul class="social-media-list">
					
					<li>
						<a href="https://github.com/swa19"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">swa19</span></a>

					</li>
					
				</ul>
			</div>
			<div class="footer-col footer-col-3">
				<p>我不是个伟大的程序员，我只是个有着一些优秀习惯的好程序员--by Kent Beck</p>
			</div>
		</div>
	</div>
</footer>


</body>
</html>